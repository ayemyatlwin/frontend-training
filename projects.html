<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style/header.css" />
    <link rel="stylesheet" href="./style/project.css" />

    <title>Projects</title>
  </head>
  <body>
    <!-- #region Header -->
    <header id="header-placeholder"></header>
    <!-- #endregion -->

    <!-- #region Project -- To-DO-LIST -->
    <section>
      <h2>To-Do List</h2>
      <input type="text" id="taskInput" placeholder="Add a new task" />
      <button id="addTask">Add</button>

      <ul id="taskList"></ul>
    </section>
    <!-- #endregion -->

    <!-- #region Project -- Counter -->

    <section>
      <h2>Counter</h2>
      <div id="count">0</div>
      <button id="increase">Increase</button>
      <button id="decrease">Decrease</button>
      <button id="reset">Reset</button>
    </section>
    <!-- #endregion -->

    <!-- #region Project -- FORM CRUD -->

    <section>
      <h2>User Form</h2>

      <form id="userForm">
        <div>
          <label>User Name:</label><br />
          <input type="text" id="username" />
        </div>

        <div>
          <label>Phone:</label><br />
          <input type="text" id="phone" />
        </div>

        <div>
          <label>Age:</label><br />
          <input type="number" id="age" />
        </div>

        <div>
          <label>Gender:</label><br />
          <select id="gender">
            <option value="">Select gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
        </div>

        <div class="error" id="errorMsg"></div>

        <button type="submit">Save</button>
      </form>

      <h3>User List</h3>

      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Phone</th>
            <th>Age</th>
            <th>Gender</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="userTable"></tbody>
      </table>
    </section>
    <!-- #endregion -->

    <script>
      //#region  Project -- To-DO-LIST
      const input = document.getElementById("taskInput");
      const addBtn = document.getElementById("addTask");
      const taskList = document.getElementById("taskList");

      let tasks = [];

      addBtn.addEventListener("click", () => {
        const task = input.value.trim();
        if (task === "") {
          alert("Task cannot be empty!");
          return;
        }

        tasks.push(task);
        input.value = "";
        renderTasks();
      });

      function renderTasks() {
        taskList.innerHTML = "";
        tasks.forEach((task, index) => {
          const li = document.createElement("li");
          li.textContent = task;

          // Edit button
          const editBtn = document.createElement("button");
          editBtn.textContent = "Edit";
          editBtn.onclick = () => editTask(index);
          li.appendChild(editBtn);

          // Delete button
          const delBtn = document.createElement("button");
          delBtn.textContent = "Delete";
          delBtn.onclick = () => deleteTask(index);
          li.appendChild(delBtn);

          taskList.appendChild(li);
        });
      }

      function editTask(index) {
        const newTask = prompt("Edit task:", tasks[index]);
        if (newTask !== null && newTask.trim() !== "") {
          tasks[index] = newTask.trim();
          renderTasks();
        }
      }

      function deleteTask(index) {
        tasks.splice(index, 1);
        renderTasks();
      }
      // #endregion

      // #region Project -- Counter
      let count = 0;
      const countDiv = document.getElementById("count");

      document.getElementById("increase").addEventListener("click", () => {
        count++;
        countDiv.textContent = count;
      });

      document.getElementById("decrease").addEventListener("click", () => {
        count--;
        countDiv.textContent = count;
      });

      document.getElementById("reset").addEventListener("click", () => {
        count = 0;
        countDiv.textContent = count;
      });
      // #endregion

      //#region Project -- FORM CRUD
      const form = document.getElementById("userForm");
      const errorMsg = document.getElementById("errorMsg");
      const table = document.getElementById("userTable");

      let users = [];
      let editIndex = null;

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const username = document.getElementById("username").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const age = document.getElementById("age").value.trim();
        const gender = document.getElementById("gender").value;

        // Validation
        if (!username || !phone || !age || !gender) {
          errorMsg.textContent = "All fields are required";
          return;
        }

        if (phone.length < 8) {
          errorMsg.textContent = "Phone must be at least 8 digits";
          return;
        }

        if (age <= 0) {
          errorMsg.textContent = "Age must be greater than 0";
          return;
        }

        errorMsg.textContent = "";

        const userData = { username, phone, age, gender };

        if (editIndex === null) {
          users.push(userData);
        } else {
          users[editIndex] = userData;
          editIndex = null;
        }

        form.reset();
        renderUsers();
      });

      function renderUsers() {
        table.innerHTML = "";

        users.forEach((user, index) => {
          const row = document.createElement("tr");

          row.innerHTML = `
        <td>${user.username}</td>
        <td>${user.phone}</td>
        <td>${user.age}</td>
        <td>${user.gender}</td>
        <td>
          <button onclick="editUser(${index})">Edit</button>
          <button onclick="deleteUser(${index})">Delete</button>
        </td>
      `;

          table.appendChild(row);
        });
      }

      function editUser(index) {
        const user = users[index];

        document.getElementById("username").value = user.username;
        document.getElementById("phone").value = user.phone;
        document.getElementById("age").value = user.age;
        document.getElementById("gender").value = user.gender;

        editIndex = index;
      }

      function deleteUser(index) {
        users.splice(index, 1);
        renderUsers();
      }

      // #endregion

      // #region Header
      fetch("header.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("header-placeholder").innerHTML = data;

          const hamburger = document.getElementById("hamburger");
          const navLinks = document.getElementById("navLinks");

          hamburger.addEventListener("click", () => {
            navLinks.classList.toggle("active");
          });

          navLinks.querySelectorAll("a").forEach((link) => {
            link.addEventListener("click", () => {
              if (navLinks.classList.contains("active")) {
                navLinks.classList.remove("active");
              }
            });
          });
        });

      // #endregion
    </script>
  </body>
</html>
